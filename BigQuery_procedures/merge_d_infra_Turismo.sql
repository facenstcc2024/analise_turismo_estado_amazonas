CREATE OR REPLACE PROCEDURE `tccfacens2024-435322.TCC_Turismo.merge_d_infra_Turismo`()
BEGIN
  MERGE `tccfacens2024-435322.TCC_Turismo.d_infra_Turismo` tgt
  USING (
    SELECT
      NO_MUNICIPIO,
      PROJETOS_MTUR,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_AGRICULTURA_E_PECUARIA,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_TURISMO,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_OUTROS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_SERVICOS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_COMERCIO,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_INDUSTRIA_DE_BASE,
      FUNDO_MUNICIPAL_TURISMO,
      PLANO_MUNICIPAL_TURISMO,
      PLANO_MKT_TURISMO,
      PROJETOS_ATIVIDADE_TURISTICA,
      CAST(HOSPEDAGEM_QT AS INT64) AS HOSPEDAGEM_QT,
      CAST(LEITOS_QT AS INT64) AS LEITOS_QT,
      LOCADORAS_VEICULOS,
      CAST(AGENCIAS_BANCARIAS_QT AS INT64) AS AGENCIAS_BANCARIAS_QT,
      AEROPORTO,
      TIPOS_TRANSPORTE,
      TIPOS_TRANSPORTE_RODOVIARIO,
      TIPOS_TRANSPORTE_AQUAVIARIO,
      TIPOS_TRANSPORTE_AEREO,
      TIPOS_TRANSPORTE_OUTROS,
      ACESSO_DESTINO_TURISTICO,
      ACESSO_DESTINO_TURISTICO_HIDROVIA,
      ACESSO_DESTINO_TURISTICO_RODOVIA,
      ACESSO_DESTINO_TURISTICO_AEROPORTO,
      ACESSO_DESTINO_TURISTICO_FERROVIA,
      ACESSO_DESTINO_TURISTICO_OUTROS,
      SITUACAO_SINALIZACAO,
      ROTA_TURISTICA,
      INTERLIGACAO_ENTRE_ATRATIVOS,
      SINALIZACAO_ACESSIBILIDADE,
      RESERVA_ESPACO_ACESSIBILIDADE,
      PROFISSIONAIS_ACESSIBILIDADE,
      CAST(EMPRESAS_TURISMO_QT AS INT64) AS EMPRESAS_TURISMO_QT,
      TIPOS_PATRIMONIO_NATURAL,
      TIPOS_PATRIMONIO_NATURAL_PARQUES_NATURAIS,
      TIPOS_PATRIMONIO_NATURAL_UNIDADE_DE_CONSERVACAO,
      TIPOS_PATRIMONIO_NATURAL_RESERVAS_ECOLOGICAS,
      TIPOS_PATRIMONIO_NATURAL_OUTROS,
      UNIDADES_CONSERVACAO,
      TIPOS_PATRIMONIO_CULTURAL,
      PATRIMONIO_CULTURAL_HISTORICO,
      PATRIMONIO_CULTURAL_EQUIPAMENTOS,
      PATRIMONIO_CULTURAL_OUTROS,
      BARCOS_TURISMO,
      TURISMO_PESCA,
      TURISMO_MERGULHO
    FROM `tccfacens2024-435322.TCC_Turismo_staging.d_infra_Turismo`
  ) AS src
  ON tgt.NO_MUNICIPIO = src.NO_MUNICIPIO

  WHEN MATCHED THEN
    UPDATE SET
      tgt.NO_MUNICIPIO = src.NO_MUNICIPIO,
      tgt.PROJETOS_MTUR = src.PROJETOS_MTUR,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_AGRICULTURA_E_PECUARIA = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_AGRICULTURA_E_PECUARIA,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_TURISMO = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_TURISMO,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_OUTROS = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_OUTROS,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_SERVICOS = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_SERVICOS,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_COMERCIO = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_COMERCIO,
      tgt.PRINCIPAIS_ATIVIDADES_ECONOMICAS_INDUSTRIA_DE_BASE = src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_INDUSTRIA_DE_BASE,
      tgt.FUNDO_MUNICIPAL_TURISMO = src.FUNDO_MUNICIPAL_TURISMO,
      tgt.PLANO_MUNICIPAL_TURISMO = src.PLANO_MUNICIPAL_TURISMO,
      tgt.PLANO_MKT_TURISMO = src.PLANO_MKT_TURISMO,
      tgt.PROJETOS_ATIVIDADE_TURISTICA = src.PROJETOS_ATIVIDADE_TURISTICA,
      tgt.HOSPEDAGEM_QT = src.HOSPEDAGEM_QT,
      tgt.LEITOS_QT = src.LEITOS_QT,
      tgt.LOCADORAS_VEICULOS = src.LOCADORAS_VEICULOS,
      tgt.AGENCIAS_BANCARIAS_QT = src.AGENCIAS_BANCARIAS_QT,
      tgt.AEROPORTO = src.AEROPORTO,
      tgt.TIPOS_TRANSPORTE = src.TIPOS_TRANSPORTE,
      tgt.TIPOS_TRANSPORTE_RODOVIARIO = src.TIPOS_TRANSPORTE_RODOVIARIO,
      tgt.TIPOS_TRANSPORTE_AQUAVIARIO = src.TIPOS_TRANSPORTE_AQUAVIARIO,
      tgt.TIPOS_TRANSPORTE_AEREO = src.TIPOS_TRANSPORTE_AEREO,
      tgt.TIPOS_TRANSPORTE_OUTROS = src.TIPOS_TRANSPORTE_OUTROS,
      tgt.ACESSO_DESTINO_TURISTICO = src.ACESSO_DESTINO_TURISTICO,
      tgt.ACESSO_DESTINO_TURISTICO_HIDROVIA = src.ACESSO_DESTINO_TURISTICO_HIDROVIA,
      tgt.ACESSO_DESTINO_TURISTICO_RODOVIA = src.ACESSO_DESTINO_TURISTICO_RODOVIA,
      tgt.ACESSO_DESTINO_TURISTICO_AEROPORTO = src.ACESSO_DESTINO_TURISTICO_AEROPORTO,
      tgt.ACESSO_DESTINO_TURISTICO_FERROVIA = src.ACESSO_DESTINO_TURISTICO_FERROVIA,
      tgt.ACESSO_DESTINO_TURISTICO_OUTROS = src.ACESSO_DESTINO_TURISTICO_OUTROS,
      tgt.SITUACAO_SINALIZACAO = src.SITUACAO_SINALIZACAO,
      tgt.ROTA_TURISTICA = src.ROTA_TURISTICA,
      tgt.INTERLIGACAO_ENTRE_ATRATIVOS = src.INTERLIGACAO_ENTRE_ATRATIVOS,
      tgt.SINALIZACAO_ACESSIBILIDADE = src.SINALIZACAO_ACESSIBILIDADE,
      tgt.RESERVA_ESPACO_ACESSIBILIDADE = src.RESERVA_ESPACO_ACESSIBILIDADE,
      tgt.PROFISSIONAIS_ACESSIBILIDADE = src.PROFISSIONAIS_ACESSIBILIDADE,
      tgt.EMPRESAS_TURISMO_QT = src.EMPRESAS_TURISMO_QT,
      tgt.TIPOS_PATRIMONIO_NATURAL = src.TIPOS_PATRIMONIO_NATURAL,
      tgt.TIPOS_PATRIMONIO_NATURAL_PARQUES_NATURAIS = src.TIPOS_PATRIMONIO_NATURAL_PARQUES_NATURAIS,
      tgt.TIPOS_PATRIMONIO_NATURAL_UNIDADE_DE_CONSERVACAO = src.TIPOS_PATRIMONIO_NATURAL_UNIDADE_DE_CONSERVACAO,
      tgt.TIPOS_PATRIMONIO_NATURAL_RESERVAS_ECOLOGICAS = src.TIPOS_PATRIMONIO_NATURAL_RESERVAS_ECOLOGICAS,
      tgt.TIPOS_PATRIMONIO_NATURAL_OUTROS = src.TIPOS_PATRIMONIO_NATURAL_OUTROS,
      tgt.UNIDADES_CONSERVACAO = src.UNIDADES_CONSERVACAO,
      tgt.TIPOS_PATRIMONIO_CULTURAL = src.TIPOS_PATRIMONIO_CULTURAL,
      tgt.PATRIMONIO_CULTURAL_HISTORICO = src.PATRIMONIO_CULTURAL_HISTORICO,
      tgt.PATRIMONIO_CULTURAL_EQUIPAMENTOS = src.PATRIMONIO_CULTURAL_EQUIPAMENTOS,
      tgt.PATRIMONIO_CULTURAL_OUTROS = src.PATRIMONIO_CULTURAL_OUTROS,
      tgt.BARCOS_TURISMO = src.BARCOS_TURISMO,
      tgt.TURISMO_PESCA = src.TURISMO_PESCA

,
      tgt.TURISMO_MERGULHO = src.TURISMO_MERGULHO

  WHEN NOT MATCHED BY TARGET THEN
    INSERT (
      NO_MUNICIPIO,
      PROJETOS_MTUR,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_AGRICULTURA_E_PECUARIA,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_TURISMO,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_OUTROS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_SERVICOS,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_COMERCIO,
      PRINCIPAIS_ATIVIDADES_ECONOMICAS_INDUSTRIA_DE_BASE,
      FUNDO_MUNICIPAL_TURISMO,
      PLANO_MUNICIPAL_TURISMO,
      PLANO_MKT_TURISMO,
      PROJETOS_ATIVIDADE_TURISTICA,
      HOSPEDAGEM_QT,
      LEITOS_QT,
      LOCADORAS_VEICULOS,
      AGENCIAS_BANCARIAS_QT,
      AEROPORTO,
      TIPOS_TRANSPORTE,
      TIPOS_TRANSPORTE_RODOVIARIO,
      TIPOS_TRANSPORTE_AQUAVIARIO,
      TIPOS_TRANSPORTE_AEREO,
      TIPOS_TRANSPORTE_OUTROS,
      ACESSO_DESTINO_TURISTICO,
      ACESSO_DESTINO_TURISTICO_HIDROVIA,
      ACESSO_DESTINO_TURISTICO_RODOVIA,
      ACESSO_DESTINO_TURISTICO_AEROPORTO,
      ACESSO_DESTINO_TURISTICO_FERROVIA,
      ACESSO_DESTINO_TURISTICO_OUTROS,
      SITUACAO_SINALIZACAO,
      ROTA_TURISTICA,
      INTERLIGACAO_ENTRE_ATRATIVOS,
      SINALIZACAO_ACESSIBILIDADE,
      RESERVA_ESPACO_ACESSIBILIDADE,
      PROFISSIONAIS_ACESSIBILIDADE,
      EMPRESAS_TURISMO_QT,
      TIPOS_PATRIMONIO_NATURAL,
      TIPOS_PATRIMONIO_NATURAL_PARQUES_NATURAIS,
      TIPOS_PATRIMONIO_NATURAL_UNIDADE_DE_CONSERVACAO,
      TIPOS_PATRIMONIO_NATURAL_RESERVAS_ECOLOGICAS,
      TIPOS_PATRIMONIO_NATURAL_OUTROS,
      UNIDADES_CONSERVACAO,
      TIPOS_PATRIMONIO_CULTURAL,
      PATRIMONIO_CULTURAL_HISTORICO,
      PATRIMONIO_CULTURAL_EQUIPAMENTOS,
      PATRIMONIO_CULTURAL_OUTROS,
      BARCOS_TURISMO,
      TURISMO_PESCA,
      TURISMO_MERGULHO
    )
    VALUES (
      src.NO_MUNICIPIO,
      src.PROJETOS_MTUR,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_AGRICULTURA_E_PECUARIA,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_TURISMO,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_OUTROS,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_SERVICOS,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_COMERCIO,
      src.PRINCIPAIS_ATIVIDADES_ECONOMICAS_INDUSTRIA_DE_BASE,
      src.FUNDO_MUNICIPAL_TURISMO,
      src.PLANO_MUNICIPAL_TURISMO,
      src.PLANO_MKT_TURISMO,
      src.PROJETOS_ATIVIDADE_TURISTICA,
      src.HOSPEDAGEM_QT,
      src.LEITOS_QT,
      src.LOCADORAS_VEICULOS,
      src.AGENCIAS_BANCARIAS_QT,
      src.AEROPORTO,
      src.TIPOS_TRANSPORTE,
      src.TIPOS_TRANSPORTE_RODOVIARIO,
      src.TIPOS_TRANSPORTE_AQUAVIARIO,
      src.TIPOS_TRANSPORTE_AEREO,
      src.TIPOS_TRANSPORTE_OUTROS,
      src.ACESSO_DESTINO_TURISTICO,
      src.ACESSO_DESTINO_TURISTICO_HIDROVIA,
      src.ACESSO_DESTINO_TURISTICO_RODOVIA,
      src.ACESSO_DESTINO_TURISTICO_AEROPORTO,
      src.ACESSO_DESTINO_TURISTICO_FERROVIA,
      src.ACESSO_DESTINO_TURISTICO_OUTROS,
      src.SITUACAO_SINALIZACAO,
      src.ROTA_TURISTICA,
      src.INTERLIGACAO_ENTRE_ATRATIVOS,
      src.SINALIZACAO_ACESSIBILIDADE,
      src.RESERVA_ESPACO_ACESSIBILIDADE,
      src.PROFISSIONAIS_ACESSIBILIDADE,
      src.EMPRESAS_TURISMO_QT,
      src.TIPOS_PATRIMONIO_NATURAL,
      src.TIPOS_PATRIMONIO_NATURAL_PARQUES_NATURAIS,
      src.TIPOS_PATRIMONIO_NATURAL_UNIDADE_DE_CONSERVACAO,
      src.TIPOS_PATRIMONIO_NATURAL_RESERVAS_ECOLOGICAS,
      src.TIPOS_PATRIMONIO_NATURAL_OUTROS,
      src.UNIDADES_CONSERVACAO,
      src.TIPOS_PATRIMONIO_CULTURAL,
      src.PATRIMONIO_CULTURAL_HISTORICO,
      src.PATRIMONIO_CULTURAL_EQUIPAMENTOS,
      src.PATRIMONIO_CULTURAL_OUTROS,
      src.BARCOS_TURISMO,
      src.TURISMO_PESCA,
      src.TURISMO_MERGULHO
    );

DELETE FROM `tccfacens2024-435322.TCC_Turismo_staging.d_infra_Turismo` WHERE 1 = 1;

END;